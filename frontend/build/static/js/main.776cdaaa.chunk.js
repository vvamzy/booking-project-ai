(this["webpackJsonpsmart-meeting-room-system"]=this["webpackJsonpsmart-meeting-room-system"]||[]).push([[0],{16:function(e,t,a){"use strict";a.r(t),a.d(t,"getRooms",function(){return m}),a.d(t,"getRoom",function(){return u}),a.d(t,"bookRoom",function(){return h}),a.d(t,"getAllBookings",function(){return O}),a.d(t,"getPendingApprovals",function(){return x}),a.d(t,"updateBookingStatus",function(){return g}),a.d(t,"cancelBooking",function(){return p}),a.d(t,"getAiDecision",function(){return v}),a.d(t,"validateBooking",function(){return N}),a.d(t,"requestAiAnalysis",function(){return y}),a.d(t,"updateBooking",function(){return f}),a.d(t,"checkAvailability",function(){return w}),a.d(t,"getSuggestions",function(){return k}),a.d(t,"getAdminAnalyticsOverview",function(){return S});var s=a(8),c=a(21),n=a.n(c);const i="http://localhost:8080",o="".concat(i,"/api"),l=parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:8080",REACT_APP_WS_URL:"ws://localhost:8080/ws"}).REACT_APP_API_TIMEOUT||"30000",10),r=parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:8080",REACT_APP_WS_URL:"ws://localhost:8080/ws"}).REACT_APP_MAX_RETRIES||"3",10),d=parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:8080",REACT_APP_WS_URL:"ws://localhost:8080/ws"}).REACT_APP_RETRY_DELAY||"1000",10);class b extends Error{constructor(e,t,a){super(t),this.status=void 0,this.data=void 0,this.name="ApiError",this.status=e,this.data=a,Object.setPrototypeOf(this,b.prototype)}}n.a.defaults.withCredentials=!0;const j=n.a.create({baseURL:o,timeout:l,headers:{"Content-Type":"application/json"},withCredentials:!0});j.interceptors.response.use(e=>e,async e=>{var t,a,s,c,n;const i=e.config||{};if(i.retries=i.retries||0,i.retries<r&&((null===(t=e.response)||void 0===t?void 0:t.status)||500)>=500)return i.retries+=1,await new Promise(e=>setTimeout(e,d)),j(i);const o=(null===(a=e.response)||void 0===a?void 0:a.status)||500,l=(null===(s=e.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.message)||e.message,m=null===(n=e.response)||void 0===n?void 0:n.data;throw new b(o,l,m)});const m=async()=>{try{return(await n.a.get("".concat(i,"/api/rooms"))).data}catch(e){if(e instanceof b)throw e;throw new b(500,"Failed to fetch rooms")}},u=async e=>{try{return(await n.a.get("".concat(i,"/api/rooms/").concat(e))).data}catch(t){if(t instanceof b)throw t;throw new b(500,"Failed to fetch room")}},h=async e=>{try{const t=Object(s.a)({},e);delete t.userId,t.priority=e.priority||3,t.notes=e.notes||"",t.attendeesCount=e.attendeesCount,t.requiredFacilities=e.requiredFacilities;return(await n.a.post("".concat(i,"/api/bookings"),t)).data}catch(t){if(t instanceof b)throw t;throw new b(500,"Failed to create booking")}},O=async()=>{try{return(await n.a.get("".concat(i,"/api/bookings"))).data}catch(e){if(e instanceof b)throw e;throw new b(500,"Failed to fetch bookings")}},x=async()=>{try{return(await n.a.get("".concat(i,"/api/bookings/pending"))).data}catch(e){if(e instanceof b)throw e;throw new b(500,"Failed to fetch pending approvals")}},g=async(e,t,a)=>{try{return(await n.a.post("".concat(i,"/api/bookings/").concat(e,"/").concat(t),{comments:a})).data}catch(s){if(s instanceof b)throw s;throw new b(500,"Failed to ".concat(t," booking"))}},p=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",a=arguments.length>2?arguments[2]:void 0;try{await n.a.put("".concat(i,"/api/bookings/").concat(e,"/cancel"),null,{params:{cancelledBy:t,reason:a}})}catch(s){if(s instanceof b)throw s;throw new b(500,"Failed to cancel booking")}},v=async e=>{try{return(await n.a.get("".concat(i,"/api/bookings/").concat(e,"/ai-decision"))).data}catch(t){if(t instanceof b)throw t;throw new b(500,"Failed to fetch AI decision")}},N=async e=>{try{const t=Object(s.a)({},e);delete t.userId;return(await n.a.post("".concat(i,"/api/bookings/validate"),t)).data}catch(t){if(t instanceof b)throw t;throw new b(500,"Failed to validate booking")}},y=async e=>{try{return(await n.a.post("".concat(i,"/api/bookings/").concat(e,"/analyze"))).data}catch(t){if(t instanceof b)throw t;throw new b(500,"Failed to analyze booking")}},f=async(e,t)=>{try{return(await n.a.put("".concat(i,"/api/bookings/").concat(e),Object(s.a)(Object(s.a)({},t),{},{status:t.status||"PENDING",priority:t.priority||3,notes:t.notes||"",attendeesCount:t.attendeesCount,requiredFacilities:t.requiredFacilities}))).data}catch(a){if(a instanceof b)throw a;throw new b(500,"Failed to update booking")}},w=async(e,t,a)=>{try{return(await n.a.get("".concat(i,"/api/bookings/availability"),{params:{roomId:e,start:t,end:a}})).data}catch(s){if(s instanceof b)throw s;throw new b(500,"Failed to check availability")}},k=async(e,t,a,s)=>{try{return(await n.a.get("".concat(i,"/api/bookings/suggest"),{params:{roomId:e,start:t,end:a,capacity:s}})).data}catch(c){if(c instanceof b)throw c;throw new b(500,"Failed to get suggestions")}},S=async()=>{try{return(await n.a.get("".concat(i,"/api/admin/analytics/overview"))).data}catch(e){if(e instanceof b)throw e;throw new b(500,"Failed to fetch analytics")}};t.default=j},250:function(e,t,a){},291:function(e,t,a){},297:function(e,t,a){},512:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a.n(s),n=a(251),i=a.n(n),o=a(29),l=a(15),r=a(8),d=a(16);function b(e){if(!e)return null;const t=String(e).trim();if(t.endsWith("Z")||/[+-]\d{2}:?\d{2}$/.test(t)){const e=new Date(t);return isNaN(e.getTime())?null:e}const a=t.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?/);if(a){const e=parseInt(a[1],10),t=parseInt(a[2],10)-1,s=parseInt(a[3],10),c=parseInt(a[4],10),n=parseInt(a[5],10),i=a[6]?parseInt(a[6],10):0;return new Date(e,t,s,c,n,i)}const s=new Date(t);return isNaN(s.getTime())?null:s}function j(e){if(!e)return null;const t=e=>e.toString().padStart(2,"0"),a=e.getFullYear(),s=t(e.getMonth()+1),c=t(e.getDate()),n=t(e.getHours()),i=t(e.getMinutes()),o=t(e.getSeconds());return"".concat(a,"-").concat(s,"-").concat(c,"T").concat(n,":").concat(i,":").concat(o)}function m(e){const t=b(e);return t?t.toLocaleDateString():""}function u(e){const t=b(e);return t?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}function h(e){const t=b(e);return t?t.toLocaleString():""}a(291);var O=a(0);var x=e=>{let{refreshKey:t,showAiDecisions:c=!0}=e;const[n,i]=Object(s.useState)([]),[o,l]=Object(s.useState)({}),[r,b]=Object(s.useState)(!0),[j,h]=Object(s.useState)(null),x=async()=>{b(!0),h(null);try{const[e,t]=await Promise.all([Object(d.getAllBookings)(),Object(d.getRooms)()]),a={};if(t.forEach(e=>a[e.id]=e),c){const t=["PENDING","PENDING_APPROVAL"],a=e.filter(e=>t.includes(String(e.status)));await Promise.all(a.map(async e=>{try{const t=await Object(d.getAiDecision)(e.id);t&&(e.aiDecision={decision:t.decision,confidence:t.confidence,rationale:t.rationale})}catch(t){console.warn("Could not fetch AI decision for booking ".concat(e.id,":"),t)}}))}i(e),l(a)}catch(e){console.error("Failed to load bookings:",e),h("Failed to load bookings. Please try again.")}finally{b(!1)}};return Object(s.useEffect)(()=>{x()},[t,c]),r?Object(O.jsx)("div",{className:"text-center p-4",children:Object(O.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(O.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):j?Object(O.jsx)("div",{className:"alert alert-danger",children:j}):n&&0!==n.length?Object(O.jsx)("div",{className:"bookings-list",children:Object(O.jsx)("div",{className:"table-responsive",children:Object(O.jsxs)("table",{className:"table table-bordered bookings-table",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Booking ID"}),Object(O.jsx)("th",{children:"Room"}),Object(O.jsx)("th",{children:"Time"}),Object(O.jsx)("th",{children:"Purpose"}),Object(O.jsx)("th",{children:"Attendees"}),Object(O.jsx)("th",{children:"Status"}),c&&Object(O.jsx)("th",{children:"AI Decision"}),Object(O.jsx)("th",{children:"Actions"})]})}),Object(O.jsx)("tbody",{children:n.map(e=>{const t=o[e.roomId];return Object(O.jsxs)("tr",{className:"booking-row ".concat(e.status),children:[Object(O.jsxs)("td",{className:"fw-semibold",children:["#",e.id]}),Object(O.jsxs)("td",{children:[Object(O.jsx)("div",{children:(null===t||void 0===t?void 0:t.name)||e.roomId}),t&&Object(O.jsx)("small",{className:"text-muted d-block",children:t.location})]}),Object(O.jsxs)("td",{children:[Object(O.jsx)("div",{children:m(e.startTime)}),Object(O.jsxs)("small",{className:"text-muted d-block",children:[u(e.startTime)," - ",u(e.endTime)]})]}),Object(O.jsx)("td",{children:Object(O.jsxs)("div",{className:"purpose-cell",children:[e.purpose,e.requiredFacilities.length>0&&Object(O.jsxs)("small",{className:"text-muted d-block",children:["Equipment: ",e.requiredFacilities.map(e=>{var a;return null===t||void 0===t||null===(a=t.equipment.find(t=>t.id===e))||void 0===a?void 0:a.name}).filter(Boolean).join(", ")]})]})}),Object(O.jsxs)("td",{className:"text-center",children:[e.attendeesCount,t&&Object(O.jsxs)("small",{className:"text-muted d-block",children:["of ",t.capacity]})]}),Object(O.jsx)("td",{children:Object(O.jsx)("span",{className:"status-badge badge ".concat("APPROVED"===e.status?"bg-success":"REJECTED"===e.status?"bg-danger":"bg-warning"),children:e.status.toUpperCase()})}),c&&Object(O.jsx)("td",{children:e.aiDecision?Object(O.jsxs)("div",{className:"ai-decision",children:[Object(O.jsx)("span",{className:"badge ".concat("APPROVE"===e.aiDecision.decision?"bg-success":"bg-danger"),children:e.aiDecision.decision.toUpperCase()}),Object(O.jsxs)("small",{className:"d-block mt-1",children:["Confidence: ",(100*e.aiDecision.confidence).toFixed(1),"%"]}),Object(O.jsx)("button",{className:"btn btn-link btn-sm p-0 mt-1",onClick:()=>{var t;alert(null===(t=e.aiDecision)||void 0===t?void 0:t.rationale)},children:"View Rationale"})]}):"PENDING"===e.status?Object(O.jsx)("span",{className:"text-muted",children:"Analyzing..."}):Object(O.jsx)("span",{className:"text-muted",children:"N/A"})}),Object(O.jsxs)("td",{className:"text-end",children:[Object(O.jsx)("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:async()=>{const t=prompt("Edit purpose",e.purpose||"");if(null!==t)try{const s=await Promise.resolve().then(a.bind(null,16));await s.updateBooking(e.id,{purpose:t}),await x()}catch(s){alert("Failed to update booking")}},children:"Edit"}),Object(O.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:async()=>{if(confirm("Cancel this booking?"))try{const t=await Promise.resolve().then(a.bind(null,16));await t.cancelBooking(e.id,"user"),await x()}catch(t){alert("Failed to cancel booking")}},children:"Cancel"})]})]},e.id)})})]})})}):Object(O.jsx)("div",{className:"alert alert-info text-center",children:"No bookings found."})};const g={bookings:[],rooms:[],loading:!1,error:null},p=Object(s.createContext)(void 0);function v(e,t){switch(t.type){case"SET_LOADING":return Object(r.a)(Object(r.a)({},e),{},{loading:!0,error:null});case"SET_ERROR":return Object(r.a)(Object(r.a)({},e),{},{loading:!1,error:t.payload});case"SET_BOOKINGS":return Object(r.a)(Object(r.a)({},e),{},{bookings:t.payload,loading:!1});case"SET_ROOMS":return Object(r.a)(Object(r.a)({},e),{},{rooms:t.payload,loading:!1});case"ADD_BOOKING":return Object(r.a)(Object(r.a)({},e),{},{bookings:[...e.bookings,t.payload]});case"UPDATE_BOOKING":return Object(r.a)(Object(r.a)({},e),{},{bookings:e.bookings.map(e=>e.id===t.payload.id?t.payload:e)});case"REMOVE_BOOKING":return Object(r.a)(Object(r.a)({},e),{},{bookings:e.bookings.filter(e=>e.id!==t.payload)});case"UPDATE_AI_DECISION":return Object(r.a)(Object(r.a)({},e),{},{bookings:e.bookings.map(e=>e.id===t.payload.bookingId?Object(r.a)(Object(r.a)({},e),{},{aiDecision:t.payload.aiDecision}):e)});default:return e}}function N(e){let{children:t}=e;const[a,c]=Object(s.useReducer)(v,g),n={state:a,loadBookings:Object(s.useCallback)(async()=>{c({type:"SET_LOADING"});try{const e=await Object(d.getAllBookings)();c({type:"SET_BOOKINGS",payload:e});const t=["PENDING","PENDING_APPROVAL"],a=e.filter(e=>t.includes(String(e.status)));await Promise.all(a.map(async e=>{try{const t=await Object(d.getAiDecision)(e.id);t&&c({type:"UPDATE_AI_DECISION",payload:{bookingId:e.id,aiDecision:t}})}catch(t){console.warn("Could not fetch AI decision for booking ".concat(e.id,":"),t)}}))}catch(e){c({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to load bookings"})}},[]),loadRooms:Object(s.useCallback)(async()=>{c({type:"SET_LOADING"});try{const e=await Object(d.getRooms)();c({type:"SET_ROOMS",payload:e})}catch(e){c({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to load rooms"})}},[]),createBooking:Object(s.useCallback)(async e=>{try{const t=Object(r.a)(Object(r.a)({},e),{},{status:"PENDING"}),a=await Object(d.bookRoom)(t);return c({type:"ADD_BOOKING",payload:a}),a}catch(t){const e=t instanceof Error?t.message:"Failed to create booking";throw c({type:"SET_ERROR",payload:e}),new Error(e)}},[]),handleBookingApproval:Object(s.useCallback)(async(e,t,a)=>{try{const s="APPROVE"===t?"approve":"reject";await Object(d.updateBookingStatus)(e,s,a),c({type:"REMOVE_BOOKING",payload:e})}catch(s){const e=s instanceof Error?s.message:"Failed to ".concat(t.toLowerCase()," booking");throw c({type:"SET_ERROR",payload:e}),new Error(e)}},[]),refreshAiDecision:Object(s.useCallback)(async e=>{try{const t=await Object(d.getAiDecision)(e);t&&c({type:"UPDATE_AI_DECISION",payload:{bookingId:e,aiDecision:t}})}catch(t){console.warn("Could not refresh AI decision for booking ".concat(e,":"),t)}},[])};return Object(O.jsx)(p.Provider,{value:n,children:t})}function y(){const e=Object(s.useContext)(p);if(void 0===e)throw new Error("useBooking must be used within a BookingProvider");return e}var f=e=>{let{onApprovalUpdate:t}=e;const{state:{bookings:a,rooms:c,loading:n,error:i},handleBookingApproval:o}=y(),[l,d]=Object(s.useState)({}),b=["PENDING","PENDING_APPROVAL"],j=a.filter(e=>b.includes(String(e.status))),m=async(e,a,s)=>{d(t=>Object(r.a)(Object(r.a)({},t),{},{[e]:!0}));try{await o(e,a,s),t&&t()}catch(c){console.error("Failed to ".concat(a," booking:"),c)}finally{d(t=>Object(r.a)(Object(r.a)({},t),{},{[e]:!1}))}};return n?Object(O.jsx)("div",{className:"text-center p-4",children:Object(O.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(O.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):i?Object(O.jsxs)("div",{className:"alert alert-danger",children:[Object(O.jsx)("i",{className:"bi bi-exclamation-triangle me-2"}),i]}):0===j.length?Object(O.jsxs)("div",{className:"alert alert-info text-center",children:[Object(O.jsx)("i",{className:"bi bi-check-circle me-2"}),"No pending approvals at the moment."]}):Object(O.jsx)("div",{className:"approval-queue",children:j.map(e=>{const t=c.find(t=>t.id===e.roomId),a=l[e.id]||!1,s=null===t||void 0===t?void 0:t.equipment.filter(t=>e.requiredFacilities.includes(t.id)).map(e=>e.name).join(", ");return Object(O.jsxs)("div",{className:"card mb-3 shadow-sm",children:[Object(O.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[Object(O.jsxs)("h5",{className:"mb-0",children:["Booking Request #",e.id]}),Object(O.jsx)("span",{className:"badge bg-warning",children:"Pending"})]}),Object(O.jsx)("div",{className:"card-body",children:Object(O.jsxs)("div",{className:"row",children:[Object(O.jsxs)("div",{className:"col-md-8",children:[Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("h6",{children:"Room Details"}),Object(O.jsxs)("p",{className:"mb-1",children:[Object(O.jsx)("strong",{children:(null===t||void 0===t?void 0:t.name)||"Unknown Room"}),(null===t||void 0===t?void 0:t.location)&&" (".concat(t.location,")")]}),Object(O.jsxs)("small",{className:"text-muted",children:["Attendees: ",e.attendeesCount," ",t&&"of ".concat(t.capacity," capacity")]})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("h6",{children:"Booking Details"}),Object(O.jsxs)("p",{className:"mb-1",children:[Object(O.jsx)("strong",{children:"Time:"})," ",h(e.startTime)," - ",h(e.endTime)]}),Object(O.jsxs)("p",{className:"mb-1",children:[Object(O.jsx)("strong",{children:"Purpose:"})," ",e.purpose]}),s&&Object(O.jsxs)("p",{className:"mb-1",children:[Object(O.jsx)("strong",{children:"Equipment:"})," ",s]})]}),e.aiDecision&&Object(O.jsxs)("div",{className:"alert ".concat("APPROVE"===e.aiDecision.decision?"alert-success":"alert-danger"," mb-3"),children:[Object(O.jsx)("h6",{children:"AI Recommendation"}),Object(O.jsxs)("p",{className:"mb-1",children:[Object(O.jsx)("strong",{children:"Decision:"})," ",e.aiDecision.decision.toUpperCase(),Object(O.jsxs)("span",{className:"ms-2",children:["(Confidence: ",e.aiDecision.confidence.toFixed(1),"%)"]})]}),Object(O.jsxs)("p",{className:"mb-0",children:[Object(O.jsx)("strong",{children:"Rationale:"})," ",e.aiDecision.rationale]})]})]}),Object(O.jsx)("div",{className:"col-md-4",children:Object(O.jsxs)("div",{className:"d-grid gap-2",children:[Object(O.jsx)("button",{className:"btn btn-success",onClick:()=>m(e.id,"APPROVE"),disabled:a,children:a?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("i",{className:"bi bi-check-circle me-2"}),"Approve"]})}),Object(O.jsx)("button",{className:"btn btn-danger",onClick:()=>m(e.id,"REJECT"),disabled:a,children:a?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("i",{className:"bi bi-x-circle me-2"}),"Reject"]})})]})})]})})]},e.id)})})};var w=e=>{let{show:t,onClose:a,suggestions:s,onQuickBook:c}=e;return t&&s?Object(O.jsx)("div",{className:"modal d-block",tabIndex:-1,role:"dialog",style:{background:"rgba(0,0,0,0.5)"},children:Object(O.jsx)("div",{className:"modal-dialog modal-lg",role:"document",children:Object(O.jsxs)("div",{className:"modal-content",children:[Object(O.jsxs)("div",{className:"modal-header",children:[Object(O.jsx)("h5",{className:"modal-title",children:"Suggested Alternatives"}),Object(O.jsx)("button",{type:"button",className:"btn-close",onClick:a})]}),Object(O.jsxs)("div",{className:"modal-body",children:[s.nextSlots&&s.nextSlots.length>0&&Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("h6",{children:"Next available time slots for requested room"}),Object(O.jsx)("ul",{children:s.nextSlots.map((e,t)=>Object(O.jsxs)("li",{children:[h(e.start)," - ",h(e.end)]},t))})]}),s.alternateRooms&&s.alternateRooms.length>0&&Object(O.jsxs)("div",{children:[Object(O.jsx)("h6",{children:"Alternate rooms"}),Object(O.jsx)("div",{className:"list-group",children:s.alternateRooms.slice().sort((e,t)=>{const a=Math.abs((e.room.capacity||0)-(e.requestedCapacity||0)),s=Math.abs((t.room.capacity||0)-(t.requestedCapacity||0));if(a!==s)return a-s;const c=(e.room.location||"").toLowerCase().includes((e.requestedLocation||"").toLowerCase())?0:1,n=(t.room.location||"").toLowerCase().includes((t.requestedLocation||"").toLowerCase())?0:1;if(c!==n)return c-n;const i=new Set(e.room.amenities||[]),o=new Set(t.room.amenities||[]),l=new Set(e.requestedAmenities||[]);let r=0,d=0;return l.forEach(e=>{i.has(e)&&r++,o.has(e)&&d++}),d-r}).map((e,t)=>{const a=e.room.amenities||[],s=e.requestedAmenities||[];(String(e.room.location)||"").toLowerCase().includes((String(e.requestedLocation)||"").toLowerCase());return Object(O.jsxs)("div",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsxs)("div",{style:{minWidth:"0"},children:[Object(O.jsx)("strong",{children:e.room.name}),Object(O.jsxs)("div",{className:"text-muted",children:["Location: ",e.room.location," \u2022 Capacity: ",e.room.capacity]}),Object(O.jsxs)("div",{className:"mt-1",children:[0===Math.abs((e.room.capacity||0)-(e.requestedCapacity||0))?Object(O.jsx)("span",{className:"badge bg-success me-1",children:"Capacity match"}):Object(O.jsxs)("span",{className:"badge bg-secondary me-1",children:["Capacity \xb1",Math.abs((e.room.capacity||0)-(e.requestedCapacity||0))]}),(String(e.room.location)||"").toLowerCase().includes((String(e.requestedLocation)||"").toLowerCase())?Object(O.jsx)("span",{className:"badge bg-success me-1",children:"Location match"}):null,a.filter(e=>s.includes(e)).length>0?Object(O.jsx)("span",{className:"badge bg-info me-1",children:"Amenities match"}):null]}),Object(O.jsxs)("div",{className:"text-muted mt-2",children:["Score: ",(e.score||0).toFixed(2)," \u2022 Available from: ",e.availableFrom?h(e.availableFrom):"N/A"]})]}),Object(O.jsx)("div",{children:e.availableFrom?Object(O.jsx)("button",{className:"btn btn-primary",onClick:()=>{const t=b(e.availableFrom),a=t?j(new Date(t.getTime()+36e5)):null;c(e.room.id,e.availableFrom,a||e.availableFrom)},children:"Quick book"}):Object(O.jsx)("button",{className:"btn btn-outline-secondary",disabled:!0,children:"Not Available"})})]},t)})})]})]}),Object(O.jsx)("div",{className:"modal-footer",children:Object(O.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:a,children:"Close"})})]})})}):null};var k=()=>{const[e,t]=Object(s.useState)(null),[a,c]=Object(s.useState)(!0),[n,i]=Object(s.useState)(null);Object(s.useEffect)(()=>{(async()=>{try{const e="http://localhost:8080",a=await fetch("".concat(e,"/api/auth/user"),{credentials:"include"});if(401===a.status||204===a.status)return void t(null);if(!a.ok)throw new Error("Failed to fetch user");const s=await a.json();t(s)}catch(e){const t=e instanceof Error?e.message:String(e);i(t)}finally{c(!1)}})()},[]);return{user:e,loading:a,error:n,login:async e=>{c(!0);try{const a="http://localhost:8080",s=await fetch("".concat(a,"/api/auth/login"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){const e=await s.text().catch(()=>"Login failed");throw new Error(e||"Login failed")}const c=await s.json();return t(c),!0}catch(a){const e=a instanceof Error?a.message:String(a);return i(e),!1}finally{c(!1)}},logout:async()=>{c(!0);try{const e="http://localhost:8080";await fetch("".concat(e,"/api/auth/logout"),{method:"POST",credentials:"include"}),t(null)}catch(e){const t=e instanceof Error?e.message:String(e);i(t)}finally{c(!1)}}}};const S=Object(s.createContext)(null),C=()=>{const e=Object(s.useContext)(S);if(!e)throw new Error("useAuthContext must be used within AuthProvider");return e};var A=e=>{let{children:t}=e;const a=k();return Object(O.jsx)(S.Provider,{value:a,children:t})};var E=()=>{const e=Object(l.g)(),{state:t,loadRooms:a,loadBookings:c}=y(),[n,i]=Object(s.useState)("rooms"),{user:o}=C(),b=(()=>{if(!o)return!1;const e=o.role||o.roles||o.authorities;try{if("string"===typeof e)return"admin"===e.toLowerCase()||"ROLE_ADMIN"===e;if(Array.isArray(e))return e.includes("admin")||e.includes("ROLE_ADMIN")||e.includes("ROLE_ADMINISTRATOR")}catch(t){return!1}if(o.authorities)try{return o.authorities.some(e=>"ROLE_ADMIN"===String((null===e||void 0===e?void 0:e.authority)||e).toUpperCase())}catch(t){}return!1})(),[m,u]=Object(s.useState)("all"),[h,g]=Object(s.useState)(""),[p,v]=Object(s.useState)(""),[N,k]=Object(s.useState)(""),[S,A]=Object(s.useState)({}),[E,R]=Object(s.useState)(null),[I,D]=Object(s.useState)(!1),[P,T]=Object(s.useState)(null);Object(s.useEffect)(()=>{(async()=>{await Promise.all([a(),c()])})()},[a,c]),Object(s.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("tab");"bookings"===e&&i("bookings"),"approvals"===e&&b&&i("approvals")},[b]);const _=async()=>{await Promise.all([a(),c()])};return Object(s.useEffect)(()=>{(async()=>{if(!h||!p)return A({});const e=new Date("".concat(h,"T").concat(p)),a=j(e)||(new Date).toISOString(),s=j(new Date(e.getTime()+36e5))||(new Date).toISOString(),c={};await Promise.all(t.rooms.map(async e=>{try{const t=await d.checkAvailability(e.id,a,s);c[e.id]=!!t.available}catch(t){c[e.id]=!0}})),A(c)})()},[h,p,t.rooms]),t.loading?Object(O.jsx)("div",{className:"container py-5",children:Object(O.jsx)("div",{className:"text-center",children:Object(O.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(O.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})}):Object(O.jsxs)("div",{className:"container py-4",children:[Object(O.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[Object(O.jsx)("h1",{children:"Smart Meeting Room System"}),Object(O.jsxs)("button",{className:"btn btn-outline-primary",onClick:_,children:[Object(O.jsx)("i",{className:"bi bi-arrow-clockwise me-2"}),"Refresh"]})]}),t.error&&Object(O.jsxs)("div",{className:"alert alert-danger mb-4",children:[Object(O.jsx)("i",{className:"bi bi-exclamation-triangle me-2"}),t.error]}),Object(O.jsxs)("ul",{className:"nav nav-tabs mb-4",children:[Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsxs)("button",{className:"nav-link ".concat("rooms"===n?"active":""),onClick:()=>i("rooms"),children:[Object(O.jsx)("i",{className:"bi bi-building me-2"}),"Rooms"]})}),Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsxs)("button",{className:"nav-link ".concat("bookings"===n?"active":""),onClick:()=>i("bookings"),children:[Object(O.jsx)("i",{className:"bi bi-calendar-event me-2"}),"Bookings"]})}),b&&Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsxs)("button",{className:"nav-link ".concat("approvals"===n?"active":""),onClick:()=>i("approvals"),children:[Object(O.jsx)("i",{className:"bi bi-check-square me-2"}),"Approvals"]})})]}),"rooms"===n&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[Object(O.jsx)("div",{children:Object(O.jsxs)("div",{className:"d-flex g-2",children:[Object(O.jsx)("input",{className:"form-control form-control-sm me-2",type:"date",value:h,onChange:e=>g(e.target.value)}),Object(O.jsx)("input",{className:"form-control form-control-sm me-2",type:"time",value:p,onChange:e=>v(e.target.value)}),Object(O.jsx)("input",{className:"form-control form-control-sm",placeholder:"Location",value:N,onChange:e=>k(e.target.value)})]})}),Object(O.jsxs)("div",{className:"btn-group",children:[Object(O.jsx)("button",{className:"btn btn-outline-primary ".concat("all"===m?"active":""),onClick:()=>u("all"),children:"All Rooms"}),Object(O.jsx)("button",{className:"btn btn-outline-primary ".concat("available"===m?"active":""),onClick:()=>u("available"),children:"Available"}),Object(O.jsx)("button",{className:"btn btn-outline-primary ".concat("booked"===m?"active":""),onClick:()=>u("booked"),children:"Booked"})]}),Object(O.jsxs)("button",{className:"btn btn-primary",onClick:()=>e.push("/book"),children:[Object(O.jsx)("i",{className:"bi bi-plus-circle me-2"}),"New Booking"]})]}),Object(O.jsx)("div",{className:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4",children:(e=>{let t=e;if(h&&p){"".concat(h,"T").concat(p);if(Object.keys(S).length>0){const e=t.map(e=>Object(r.a)(Object(r.a)({},e),{},{_available:S[e.id]}));t=e.filter(Boolean)}}switch(N&&(t=t.filter(e=>e.location&&e.location.toLowerCase().includes(N.toLowerCase()))),m){case"available":return t.filter(e=>!0===e._available||e.status&&"available"===e.status.toLowerCase());case"booked":return t.filter(e=>!1===e._available||e.status&&"booked"===e.status.toLowerCase());default:return t}})(t.rooms).map(t=>Object(O.jsx)("div",{className:"col",children:Object(O.jsx)("div",{className:"card h-100",children:Object(O.jsxs)("div",{className:"card-body d-flex flex-column",children:[Object(O.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[Object(O.jsx)("h5",{className:"card-title mb-0",children:t.name}),Object(O.jsx)("small",{className:"text-muted",children:t.location})]}),Object(O.jsxs)("p",{className:"card-text text-muted",children:["Capacity: ",t.capacity]}),Object(O.jsxs)("div",{className:"mt-auto d-flex justify-content-between align-items-center",children:[Object(O.jsx)("div",{children:h&&p&&Object.keys(S).length>0?S[t.id]?Object(O.jsx)("span",{className:"badge bg-success",children:"Available"}):Object(O.jsx)("span",{className:"badge bg-danger",children:"Booked"}):Object(O.jsxs)("span",{className:"badge bg-secondary",children:["Status: ",t.status]})}),Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{className:"btn btn-sm btn-outline-primary me-2",onClick:()=>e.push("/book/".concat(t.id)),children:"Book"}),Object(O.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:async()=>{const e=h&&p?new Date("".concat(h,"T").concat(p)):new Date,a=j(e)||(new Date).toISOString(),s=j(new Date(e.getTime()+36e5))||(new Date).toISOString();try{const e=await d.getSuggestions(t.id,a,s,t.capacity);R(e),T(t),D(!0)}catch(c){console.error("Failed to fetch suggestions",c),alert("Could not fetch suggestions.")}},children:"View suggestions"})]})]})]})})},t.id))}),0===t.rooms.length&&Object(O.jsxs)("div",{className:"text-center py-5 text-muted",children:[Object(O.jsx)("i",{className:"bi bi-emoji-neutral display-4"}),Object(O.jsx)("p",{className:"mt-3",children:"No rooms available."})]}),Object(O.jsx)(w,{show:I,onClose:()=>{D(!1),R(null),T(null)},suggestions:E,onQuickBook:async(e,t,s)=>{try{await d.bookRoom({roomId:e,userId:0,startTime:t,endTime:s,purpose:"Quick booking (suggestion)",attendeesCount:P?Math.min(P.capacity,1):1,requiredFacilities:[],status:"PENDING",priority:3,notes:""}),D(!1),R(null),T(null),await a(),await c()}catch(n){console.error("Quick book failed",n),alert("Quick book failed")}}})]}),"bookings"===n&&Object(O.jsx)(x,{showAiDecisions:!0}),"approvals"===n&&(b?Object(O.jsx)(f,{onApprovalUpdate:_}):Object(O.jsx)("div",{className:"alert alert-warning",children:"You are not authorized to view approvals."}))]})};var R=e=>{let{show:t,initialPurpose:a,rationale:n,onClose:i,onConfirm:o}=e;const[l,r]=Object(s.useState)(a||"");return c.a.useEffect(()=>{r(a||"")},[a,t]),t?Object(O.jsx)("div",{className:"modal-backdrop",children:Object(O.jsx)("div",{className:"modal-dialog modal-lg",children:Object(O.jsxs)("div",{className:"modal-content",children:[Object(O.jsxs)("div",{className:"modal-header",children:[Object(O.jsx)("h5",{className:"modal-title",children:"Clarify Meeting Purpose"}),Object(O.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:i})]}),Object(O.jsxs)("div",{className:"modal-body",children:[Object(O.jsx)("p",{children:"The booking purpose was flagged as unclear. Please clarify so the system can validate it."}),n&&n.length>0&&Object(O.jsxs)("div",{className:"alert alert-warning",children:[Object(O.jsx)("strong",{children:"Reason(s):"}),Object(O.jsx)("ul",{children:n.map((e,t)=>Object(O.jsx)("li",{children:e},t))})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Purpose"}),Object(O.jsx)("textarea",{className:"form-control",rows:4,value:l,onChange:e=>r(e.target.value)})]})]}),Object(O.jsxs)("div",{className:"modal-footer",children:[Object(O.jsx)("button",{className:"btn btn-secondary",onClick:i,children:"Cancel"}),Object(O.jsx)("button",{className:"btn btn-primary",onClick:()=>o(l),children:"Re-validate"})]})]})})}):null};a(297);var I=e=>{let{onCreated:t,initialRoomId:c}=e;const[n,i]=Object(s.useState)(c),[o,r]=Object(s.useState)((new Date).toISOString().split("T")[0]),[b,m]=Object(s.useState)("09:00"),[u,h]=Object(s.useState)("10:00"),[x,g]=Object(s.useState)(""),[p,v]=Object(s.useState)(1),[N,f]=Object(s.useState)([]),[k,S]=Object(s.useState)(!1),[C,A]=Object(s.useState)(null),[E,I]=Object(s.useState)(null),[D,P]=Object(s.useState)(!1),[T,_]=Object(s.useState)(!1),[L,F]=Object(s.useState)(void 0),{state:{rooms:B},loadRooms:q}=y(),M=Object(l.g)();Object(s.useEffect)(()=>{0===B.length?q():!n&&B.length>0&&i(B[0].id)},[B,q,n]);const U=B.find(e=>e.id===n);return Object(O.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),A(null),S(!0);const s=(()=>{if(!n)return"Please select a room";const e=B.find(e=>e.id===n);if(!e)return"Invalid room selected";const t=new Date("".concat(o,"T").concat(b));return new Date("".concat(o,"T").concat(u))<=t?"End time must be after start time":t<new Date?"Cannot book a room in the past":p>e.capacity?"Room capacity (".concat(e.capacity,") exceeded"):x.length<10?"Please provide a more detailed purpose (minimum 10 characters)":null})();if(s)return A({type:"error",text:s}),void S(!1);if(!n)return A({type:"error",text:"Please select a room"}),void S(!1);try{var c,i;const s=new Date("".concat(o,"T").concat(b)),l=new Date("".concat(o,"T").concat(u)),O={roomId:n,startTime:null!==(c=j(s))&&void 0!==c?c:"",endTime:null!==(i=j(l))&&void 0!==i?i:"",purpose:x,attendeesCount:p,notes:"",requiredFacilities:N,status:"PENDING",priority:3},y=await Promise.resolve().then(a.bind(null,16));try{const e=await y.validateBooking(O);if(e&&!1===e.valid)return F(e.rationale||[]),_(!0),void S(!1)}catch(e){console.warn("Validation call failed, continuing to availability check",e)}if(!(await y.checkAvailability(n,O.startTime,O.endTime)).available){const e=await y.getSuggestions(n,O.startTime,O.endTime,p);return I(e),P(!0),A({type:"error",text:"Selected room is not available at requested time. Suggestions provided below."}),void S(!1)}const w=await Object(d.bookRoom)(O);A({type:"success",text:"Booking created successfully! Status: ".concat(w.status).concat(w.aiDecision?" | AI Status: "+w.aiDecision.decision:"")}),g(""),v(1),f([]),r((new Date).toISOString().split("T")[0]),m("09:00"),h("10:00"),t&&t(),M.push("/?tab=bookings")}catch(l){console.error("booking failed",l),A({type:"error",text:l instanceof Error?l.message:"Failed to create booking"})}finally{S(!1)}},className:"booking-form",children:[Object(O.jsxs)("div",{className:"mb-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"Room:"}),Object(O.jsxs)("select",{className:"form-select form-select-lg shadow-sm",value:n||"",onChange:e=>i(Number(e.target.value)),required:!0,disabled:k,children:[Object(O.jsx)("option",{value:"",children:"Select a room"}),B.map(e=>Object(O.jsxs)("option",{value:e.id,children:[e.name," (",e.location,") - Capacity: ",e.capacity]},e.id))]}),U&&Object(O.jsx)("div",{className:"text-muted mt-2",children:Object(O.jsxs)("small",{children:["Available equipment: ",U.equipment.map(e=>e.name).join(", ")]})})]}),Object(O.jsxs)("div",{className:"mb-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"Meeting Purpose:"}),Object(O.jsx)("textarea",{className:"form-control form-control-lg shadow-sm",value:x,onChange:e=>g(e.target.value),required:!0,disabled:k,placeholder:"Describe the purpose of your meeting...",rows:3,minLength:10}),Object(O.jsx)("small",{className:"text-muted",children:"Minimum 10 characters required"})]}),Object(O.jsxs)("div",{className:"mb-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"Number of Attendees:"}),Object(O.jsx)("input",{type:"number",className:"form-control form-control-lg shadow-sm",value:p,onChange:e=>v(Math.max(1,Number(e.target.value))),min:"1",max:(null===U||void 0===U?void 0:U.capacity)||999,required:!0,disabled:k}),U&&Object(O.jsxs)("small",{className:"text-muted",children:["Room capacity: ",U.capacity," people"]})]}),Object(O.jsxs)("div",{className:"row mb-4",children:[Object(O.jsxs)("div",{className:"col-md-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"Date:"}),Object(O.jsx)("input",{type:"date",className:"form-control form-control-lg shadow-sm",value:o,onChange:e=>r(e.target.value),required:!0,disabled:k,min:(new Date).toISOString().split("T")[0]})]}),Object(O.jsxs)("div",{className:"col-md-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"Start Time:"}),Object(O.jsx)("input",{type:"time",className:"form-control form-control-lg shadow-sm",value:b,onChange:e=>m(e.target.value),required:!0,disabled:k})]}),Object(O.jsxs)("div",{className:"col-md-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"End Time:"}),Object(O.jsx)("input",{type:"time",className:"form-control form-control-lg shadow-sm",value:u,onChange:e=>h(e.target.value),required:!0,disabled:k})]})]}),(null===U||void 0===U?void 0:U.equipment)&&U.equipment.length>0&&Object(O.jsxs)("div",{className:"mb-4",children:[Object(O.jsx)("label",{className:"form-label fw-semibold",children:"Required Equipment:"}),Object(O.jsx)("div",{className:"row g-3",children:U.equipment.map(e=>Object(O.jsx)("div",{className:"col-md-6 col-lg-4",children:Object(O.jsxs)("div",{className:"form-check",children:[Object(O.jsx)("input",{type:"checkbox",className:"form-check-input",id:"equipment-".concat(e.id),checked:N.includes(e.id),onChange:t=>{t.target.checked?f([...N,e.id]):f(N.filter(t=>t!==e.id))},disabled:k||e.status&&"available"!==e.status.toLowerCase()}),Object(O.jsxs)("label",{className:"form-check-label",htmlFor:"equipment-".concat(e.id),children:[e.name,Object(O.jsx)("span",{className:"ms-2 badge ".concat("available"===e.status?"bg-success":"in-use"===e.status?"bg-warning":"bg-danger"),children:e.status})]})]})},e.id))})]}),Object(O.jsx)(w,{show:D,onClose:()=>{P(!1),I(null)},suggestions:E,onQuickBook:async(e,a,s)=>{S(!0);try{const c={roomId:e,startTime:a,endTime:s,purpose:x,attendeesCount:p,requiredFacilities:N,status:"PENDING",priority:3,notes:""};await Object(d.bookRoom)(c),P(!1),I(null),t&&t(),M.push("/?tab=bookings")}catch(c){console.error("Quick book failed",c)}finally{S(!1)}}}),Object(O.jsx)(R,{show:T,initialPurpose:x,rationale:L,onClose:()=>_(!1),onConfirm:async e=>{_(!1),g(e),A(null),S(!0);try{const s=new Date("".concat(o,"T").concat(b)),c=new Date("".concat(o,"T").concat(u)),i={roomId:null!==n&&void 0!==n?n:0,userId:0,startTime:j(s)||"",endTime:j(c)||"",purpose:e,attendeesCount:p,notes:"",requiredFacilities:N,status:"PENDING",priority:3},l=await Promise.resolve().then(a.bind(null,16)),r=await l.validateBooking(i);if(r&&!1===r.valid)return A({type:"error",text:"Purpose still flagged as invalid: "+(r.rationale?r.rationale.join("; "):"")}),F(r.rationale||[]),_(!0),void S(!1);if(!(await l.checkAvailability(null!==n&&void 0!==n?n:0,i.startTime,i.endTime)).available){const e=await l.getSuggestions(null!==n&&void 0!==n?n:0,i.startTime,i.endTime,p);return I(e),P(!0),A({type:"error",text:"Selected room is not available at requested time. Suggestions provided below."}),void S(!1)}const m=await Object(d.bookRoom)(i);A({type:"success",text:"Booking created successfully! Status: ".concat(m.status)}),t&&t(),M.push("/?tab=bookings")}catch(s){console.error("booking failed",s),A({type:"error",text:s instanceof Error?s.message:"Failed to create booking"})}finally{S(!1)}}}),Object(O.jsx)("div",{className:"d-grid gap-2",children:Object(O.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg shadow transition-all hover-scale",disabled:k,children:k?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):"Book Room"})}),C&&Object(O.jsx)("div",{className:"alert alert-".concat("error"===C.type?"danger":"success"," mt-4"),children:C.text})]})};var D=()=>{const{roomId:e}=Object(l.i)(),{state:t,loadRooms:a,loadBookings:c}=y(),n=Object(l.g)();return Object(s.useEffect)(()=>{if(!t.rooms.length||!t.bookings.length){(async()=>{await Promise.all([a(),c()])})()}},[t.rooms.length,t.bookings.length,a,c]),t.loading?Object(O.jsx)("div",{className:"container py-5",children:Object(O.jsx)("div",{className:"text-center",children:Object(O.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(O.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})}):Object(O.jsxs)("div",{className:"container py-4",children:[Object(O.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[Object(O.jsx)("h1",{children:"Book a Meeting Room"}),Object(O.jsxs)("button",{className:"btn btn-outline-primary",onClick:()=>n.push("/"),children:[Object(O.jsx)("i",{className:"bi bi-arrow-left me-2"}),"Back to Dashboard"]})]}),t.error&&Object(O.jsxs)("div",{className:"alert alert-danger",children:[Object(O.jsx)("i",{className:"bi bi-exclamation-triangle me-2"}),t.error]}),Object(O.jsx)("div",{className:"row justify-content-center",children:Object(O.jsx)("div",{className:"col-md-8",children:Object(O.jsx)("div",{className:"card shadow-sm",children:Object(O.jsx)("div",{className:"card-body",children:Object(O.jsx)(I,{onCreated:()=>{n.push("/?tab=bookings")},initialRoomId:e?Number(e):void 0})})})})})]})};var P=()=>{const e=Object(l.h)(),{user:t,logout:a}=C();return Object(O.jsx)("div",{className:"container-fluid bg-light mb-4",children:Object(O.jsx)("div",{className:"container",children:Object(O.jsxs)("ul",{className:"nav nav-tabs justify-content-center",children:[Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{to:"/",className:"nav-link ".concat("/"===e.pathname?"active":""),children:"Dashboard"})}),Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{to:"/book",className:"nav-link ".concat(e.pathname.startsWith("/book")?"active":""),children:"Book Room"})}),t?Object(O.jsxs)("li",{className:"nav-item ms-auto d-flex align-items-center",children:[Object(O.jsx)("span",{className:"me-3",children:t.username}),Object(O.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>a(),children:"Logout"})]}):Object(O.jsx)("li",{className:"nav-item ms-auto",children:Object(O.jsx)(o.b,{to:"/login",className:"nav-link ".concat("/login"===e.pathname?"active":""),children:"Login"})}),t&&("ROLE_ADMIN"===t.role||"ADMIN"===t.role)&&Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{to:"/admin",className:"nav-link ".concat("/admin"===e.pathname?"active":""),children:"Admin Panel"})})]})})})},T=a(514),_=a(515),L=a(264),F=a(265),B=a(52),q=a(100),M=a(262);var U=()=>{const[e,t]=Object(s.useState)(null),[a,c]=Object(s.useState)(!0);if(Object(s.useEffect)(()=>{(async()=>{c(!0);try{const e=await d.getAdminAnalyticsOverview();t(e)}catch(e){console.error("Failed to load analytics",e)}finally{c(!1)}})()},[]),a)return Object(O.jsx)("div",{children:"Loading analytics..."});if(!e)return Object(O.jsx)("div",{children:"No analytics available."});const n=(e.topRooms||[]).map(e=>({name:e.name,value:e.count||0})),i=(e.utilization||[]).map(e=>({name:e.name,value:Math.round(1e4*(e.utilization||0))/100})),o=["#0d6efd","#6c757d","#198754","#dc3545","#fd7e14"];return Object(O.jsxs)("div",{className:"container py-4",children:[Object(O.jsx)("h2",{className:"mb-4",children:"Admin Analytics"}),Object(O.jsxs)("div",{className:"row g-4",children:[Object(O.jsx)("div",{className:"col-12 col-lg-6",children:Object(O.jsx)("div",{className:"card shadow-sm",children:Object(O.jsxs)("div",{className:"card-body",children:[Object(O.jsx)("h5",{className:"card-title",children:"Top Booked Rooms"}),Object(O.jsx)("p",{className:"text-muted small",children:"Booking counts over all time"}),Object(O.jsx)("div",{style:{width:"100%",height:260},children:Object(O.jsx)(T.a,{children:Object(O.jsxs)(_.a,{data:n,layout:"vertical",children:[Object(O.jsx)(L.a,{type:"number"}),Object(O.jsx)(F.a,{dataKey:"name",type:"category",width:150}),Object(O.jsx)(B.a,{}),Object(O.jsx)(q.a,{dataKey:"value",fill:"#0d6efd",children:n.map((e,t)=>Object(O.jsx)(M.a,{fill:o[t%o.length]},"cell-".concat(t)))})]})})})]})})}),Object(O.jsx)("div",{className:"col-12 col-lg-6",children:Object(O.jsx)("div",{className:"card shadow-sm",children:Object(O.jsxs)("div",{className:"card-body",children:[Object(O.jsx)("h5",{className:"card-title",children:"Room Utilization (last 30 days)"}),Object(O.jsx)("p",{className:"text-muted small",children:"Estimated percent of working hours booked"}),Object(O.jsx)("div",{style:{width:"100%",height:260},children:Object(O.jsx)(T.a,{children:Object(O.jsxs)(_.a,{data:i,layout:"vertical",children:[Object(O.jsx)(L.a,{type:"number",domain:[0,100],unit:"%"}),Object(O.jsx)(F.a,{dataKey:"name",type:"category",width:150}),Object(O.jsx)(B.a,{formatter:e=>e+"%"}),Object(O.jsx)(q.a,{dataKey:"value",children:i.map((e,t)=>Object(O.jsx)(M.a,{fill:o[t%o.length]},"cellu-".concat(t)))})]})})})]})})})]}),Object(O.jsx)("div",{className:"row mt-4",children:Object(O.jsx)("div",{className:"col-12",children:Object(O.jsx)("div",{className:"card shadow-sm",children:Object(O.jsxs)("div",{className:"card-body",children:[Object(O.jsx)("h5",{className:"card-title",children:"Recommendations"}),Object(O.jsx)("p",{className:"text-muted small",children:"AI-driven suggestions for resource planning"}),Object(O.jsx)("ul",{className:"list-group list-group-flush",children:(e.recommendations||[]).map((e,t)=>Object(O.jsxs)("li",{className:"list-group-item",children:[Object(O.jsx)("strong",{children:e.name}),Object(O.jsx)("div",{className:"text-muted small",children:e.reason})]},t))}),Object(O.jsxs)("div",{className:"mt-3",children:[Object(O.jsx)("h6",{children:"AI Insights"}),e.aiInsightsError&&Object(O.jsxs)("div",{className:"text-danger small",children:["AI insights error: ",e.aiInsightsError]}),e.aiInsights&&Object(O.jsxs)("div",{className:"row",children:[Object(O.jsx)("div",{className:"col-md-6",children:Object(O.jsx)("div",{className:"card mb-2",children:Object(O.jsxs)("div",{className:"card-body",children:[Object(O.jsx)("h6",{className:"card-title",children:"Insights"}),Object(O.jsx)("ul",{className:"list-group list-group-flush",children:(e.aiInsights.insights||[]).map((e,t)=>Object(O.jsx)("li",{className:"list-group-item small",children:e},t))})]})})}),Object(O.jsx)("div",{className:"col-md-6",children:Object(O.jsx)("div",{className:"card mb-2",children:Object(O.jsxs)("div",{className:"card-body",children:[Object(O.jsx)("h6",{className:"card-title",children:"AI Recommendations"}),Object(O.jsx)("ul",{className:"list-group list-group-flush",children:(e.aiInsights.recommendations||[]).map((e,t)=>Object(O.jsx)("li",{className:"list-group-item small",children:e},t))})]})})})]}),!e.aiInsights&&e.aiInsightsRaw&&Object(O.jsx)("pre",{className:"small bg-light p-2",style:{whiteSpace:"pre-wrap"},children:e.aiInsightsRaw})]})]})})})})]})};var G=()=>{const[e,t]=Object(s.useState)("approvals");return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(P,{}),Object(O.jsxs)("div",{className:"container py-4",children:[Object(O.jsx)("h1",{className:"text-center mb-4",children:"Admin Panel"}),Object(O.jsxs)("ul",{className:"nav nav-pills mb-4 justify-content-center",children:[Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)("button",{className:"nav-link ".concat("approvals"===e?"active":""),onClick:()=>t("approvals"),children:"Pending Approvals"})}),Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)("button",{className:"nav-link ".concat("bookings"===e?"active":""),onClick:()=>t("bookings"),children:"All Bookings"})}),Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)("button",{className:"nav-link ".concat("analytics"===e?"active":""),onClick:()=>t("analytics"),children:"Analytics"})})]}),"approvals"===e?Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Pending Approvals"}),Object(O.jsx)(f,{})]}):"bookings"===e?Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"All Bookings"}),Object(O.jsx)(x,{})]}):Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{className:"text-center mb-4",children:"Analytics"}),Object(O.jsx)(U,{})]})]})]})},K=a(266);const V=["component","requiredRole"];var W=e=>{let{component:t,requiredRole:a}=e,s=Object(K.a)(e,V);const{user:c,loading:n}=C();if(n)return Object(O.jsx)("div",{children:"Loading..."});const i=!a||c&&c.role===a;return Object(O.jsx)(l.b,Object(r.a)(Object(r.a)({},s),{},{render:e=>c&&i?Object(O.jsx)(t,Object(r.a)({},e)):Object(O.jsx)(l.a,{to:{pathname:"/login"}})}))};var H=()=>{const[e,t]=Object(s.useState)("alice"),{login:a,user:c,loading:n,error:i}=C(),o=Object(l.g)(),[r,d]=Object(s.useState)("alicepass");return n?Object(O.jsx)("div",{children:"Loading..."}):Object(O.jsx)("div",{className:"container py-5",children:Object(O.jsx)("div",{className:"row justify-content-center",children:Object(O.jsx)("div",{className:"col-md-6",children:Object(O.jsx)("div",{className:"card shadow-sm",children:Object(O.jsxs)("div",{className:"card-body",children:[Object(O.jsx)("h3",{className:"mb-3",children:"Login"}),i&&Object(O.jsx)("div",{className:"alert alert-danger",children:i}),Object(O.jsxs)("form",{onSubmit:async t=>{t.preventDefault();await a({username:e,password:r})&&o.push("/")},children:[Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Username"}),Object(O.jsx)("input",{className:"form-control",value:e,onChange:e=>t(e.target.value)})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Password"}),Object(O.jsx)("input",{type:"password",className:"form-control",value:r,onChange:e=>d(e.target.value)})]}),Object(O.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Login"})]})]})})})})})};a(250);const Q=e=>{let{children:t}=e;const{user:a,loading:s}=C(),c=Object(l.h)();return s?Object(O.jsx)("div",{children:"Loading..."}):a?Object(O.jsx)(O.Fragment,{children:t}):Object(O.jsx)(l.a,{to:{pathname:"/login",state:{from:c}}})};var z=()=>Object(O.jsx)(N,{children:Object(O.jsx)(A,{children:Object(O.jsx)(o.a,{children:Object(O.jsxs)("div",{className:"app",children:[Object(O.jsx)(P,{}),Object(O.jsx)("main",{className:"main-content",children:Object(O.jsxs)(l.d,{children:[Object(O.jsx)(l.b,{path:"/login",component:H}),Object(O.jsx)(l.b,{path:"/",children:Object(O.jsx)(Q,{children:Object(O.jsxs)(l.d,{children:[Object(O.jsx)(l.b,{exact:!0,path:"/",component:E}),Object(O.jsx)(l.b,{path:"/book/:roomId",component:D}),Object(O.jsx)(l.b,{exact:!0,path:"/book",component:D}),Object(O.jsx)(W,{path:"/admin",component:G,requiredRole:"ROLE_ADMIN"})]})})})]})})]})})})});a(511);const J=document.getElementById("root");J&&i.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(z,{})}),J)}},[[512,1,2]]]);
//# sourceMappingURL=main.776cdaaa.chunk.js.map